<%
meta({
  title: @channel.title,
    description: if @channel.summary then @channel.summary else "#{@channel.episodes.visible.count} episodes of #{@channel.title}. By #{@channel.author}." end,
    og: {
      title: @channel.title,
      type: 'profile',
      # TODO: If there is a channel image, pass it in here
      # image: ""
    },
  twitter: {
    #card: "summary",
    #site: "@alexbaldwin"
  }
})
%>
<% content_for :favicon do %>
  <% if @channel.image? %>
    <%= Imgix.client.path(@channel.image.current_path).width(32).height(32).fit('crop').fm('png32').to_url %>
  <% end %>
<% end %>

<header class="center py2 mt2">
  <% if @channel.image? %>
    <%= image_tag(Imgix.client.path(@channel.image.current_path).width(120).height(120).mask('ellipse').fit('crop').to_url, class: "center mb1") %>
  <% end %>
  <h1 class="m0">
    <%= @channel.title %>
  </h1>

  <% if policy(@channel).update? %>
    <%= link_to("Edit Settings", edit_channel_path(primary_channel), class: "mt2 btn btn-outline") %>
  <% end %>
</header>

<section class="flex flex-wrap mxn2 px2">
  <% @episodes.each do |t| %>
    <div class="flex col-6 md-col-4 lg-col-3 p2 border-box">
      <div class="">
        <%= link_to(slugged_channel_episode_path(@channel.slug, t.slug)) do %>
          <%= image_tag(Imgix.client.path(t.image.current_path).fit('crop').width(400).height(400).to_url, class: 'col-12 border') if t.image? %>
        <% end %>
          <div class="py1">
            <h2 class="h5 m0 black">
          <%= link_to( t.title, slugged_channel_episode_path(@channel.slug, t.slug), class: 'black') %>
            </h2>
          <h4 class="h6 regular gray m0">
            <%= "#{time_ago_in_words(t.created_at)} ago" %>
            âˆ™
            <%= distance_of_time_in_words(t.length) %>
          </h4>
        </div>
      </div>
    </div>
  <% end %>
</section>

<% if @channel.summary %>
  <div class="center py2 mx-auto col-6">
    <p class="mb0"><%= @channel.summary %></p>
  </div>
<% end %>
<% if @channel.website_url %>
  <div class="center py2">
    <%= link_to(@channel.website_url, @channel.website_url, class: "black block") if @channel.website_url %>
  </div>
<% end %>
